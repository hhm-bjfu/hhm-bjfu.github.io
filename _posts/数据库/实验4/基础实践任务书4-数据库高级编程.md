# 数据库基础实践任务书

## 实践任务四：数据库高级编程（4h）

## 【任务描述】

依托数据库实验，实践数据库高级编程。根据任务，完成函数、存储过程和触发器编写和调试。

## 【任务目的】

### 1. 了解流程控制语句的基本语法格式。能够用流程控制语句编写简单程序，实现功能。

能够使用流程控制语句完成简单程序的编写。能够使用系统函数。能够自定义简单地函数，并调用函数。

### 2. 掌握存储过程的创建和调用。

能够使用简单的系统存储过程。能够创建和执行用户自定义存储过程。能够完成存储过程的修改、删除等管理任务。

### 3. 理解触发器设计的原理与过程。

能够理解触发器调用的机制。能够使用SQL命令创建DML触发器。能够完成触发器的修改、删除等管理任务。。

## 【任务内容】

1. 针对实验4设计的电子商务系统，完成如下实践任务。

* 在商品表中，查询某种商品，如果有，就修改该商品的名称，并输出商品的信息，否则输出“没有该商品！”
* 查询商品购买信息，将商品的购买数量都加1（提示：使用流程控制语句while）。
* 定义一个用户自定义的函数，能够根据订单号，查询商品的购买数量，如果购买数量>2，输出订单号、商品名称和购买数量。

2. 针对实验4设计的电子商务系统，完成如下实践任务。

* 创建存储过程proc_1，显示购买人信息表中性别为“男”的用户信息，并调用此存储过程，显示执行结果。
* 使用sp_helptext查看存储过程proc_1的文本。
* 创建存储过程proc_2，实现为购买人信息表添加一条记录，记录内容自己定义，并调用此存储过程，显示执行结果。
* 修改存储过程proc_1，改为显示购买人信息表中性别为“女”的用户信息。
* 删除存储过程proc_1。

3. 针对实验4设计的电子商务系统，完成如下实践任务。

* 创建触发器tr1，实现当修改商品表中的数据时，显示提示信息“商品表信息被修改了。”
* 创建一个DDL触发器tr3，禁止修改和删除当前数据库中的任何表。
* 查看已创建的触发器tr1的内容。
* 删除商品表上的触发器tr1。


## 【实验注意】

### 注意事项

* 注意自定义函数的编写方法和格式。
* 注意存储过程的调用和函数调用的区别。
* 选择合适类型的触发器。



## 【实验相关教程】

无


## 【编著信息】

* 北京林业大学 信息学院 数据库课程教学组
* 主要编写人员：崔晓晖
* 版本：V0.1
* 2022-11-28
